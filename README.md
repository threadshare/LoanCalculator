# 房贷计算器

## 项目简介

本项目是一个用于计算房贷的Python程序，支持组合贷款和纯商业贷款两种方案，并支持等额本息和等额本金两种还款方式。程序将计算结果输出到Excel文件和Markdown文件中，方便用户查看和保存。

## 特性

- 支持组合贷款和纯商业贷款的计算
- 支持等额本息和等额本金两种还款方式
- 自动计算并输出详细的贷款信息和相关费用
- 结果输出到Excel和Markdown文件
- 支持命令行查看结果

## 文件结构

```plaintext
LoanCalculator/
├── config.txt         # 配置文件，用于输入贷款相关参数
├── loan_calculator.py # 主程序文件
├── loan_results.xlsx  # 计算结果的Excel文件（程序运行后生成）
├── loan_results.md    # 计算结果的Markdown文件（程序运行后生成）
```

## 配置文件 `config.txt`

配置文件包含贷款相关的参数，每行一个配置项，格式为 `key=value`，支持的配置项包括：

- `house_price`：房屋总价（万元）
- `down_payment_ratio`：首付比例（百分比）
- `fund_loan_amount`：公积金贷款金额（万元）
- `fund_loan_rate`：公积金贷款利率（百分比）
- `deed_tax_rate`：契税率（百分比）
- `loan_years`：贷款期限（年）
- `agent_fee_ratio`：中介费率（百分比）
- `commercial_loan_rate`：商业贷款利率（百分比）
- `hard_deco`：硬装费用（元）
- `whole_house_custom`：全屋定制费用（元）
- `doors_and_windows`：门窗费用（元）
- `soft_furnishings`：软装费用（元）
- `appliance`：家电费用（元）
- `miscellaneous`：杂费（元）

示例配置文件：

```ini
house_price=100.0
down_payment_ratio=30.0
fund_loan_amount=30.0
fund_loan_rate=3.25
deed_tax_rate=1.5
loan_years=30
agent_fee_ratio=2.0
commercial_loan_rate=5.0
hard_deco=500000
whole_house_custom=200000
doors_and_windows=100000
soft_furnishings=100000
appliance=100000
miscellaneous=50000
```

## 使用方法

### 环境准备

1. 确保已安装以下依赖库：

```bash
pip install pandas numpy tabulate openpyxl
```

2. 将项目目录结构准备好：

```
LoanCalculator/
├── config.txt
├── loan_calculator.py
```

### 运行程序

1. 打开命令行或终端，导航到项目目录。
2. 运行程序：

```bash
python loan_calculator.py
```

### 输出结果

运行程序后，项目目录下将生成两个文件：
- `loan_results.xlsx`：包含计算结果的Excel文件，每个方案一个工作表。
- `loan_results.md`：包含计算结果的Markdown文件，每个方案一个Markdown表格。

### 查看结果

#### 示例Markdown文件内容：

```markdown
## 组合贷款方案-等额本息
| 项目                         |    数值   |
|:----------------------------:|:---------:|
| 房屋总价(万元)               |   100.00  |
| 首付比例                     |   30.00%  |
| 首付款(万元)                 |   30.00   |
| 贷款金额(万元)               |   70.00   |
| 公积金贷款金额(万元)         |   30.00   |
| 商业贷款金额(万元)           |   40.00   |
| 公积金贷款比例               |   42.86%  |
| 商业贷款比例                 |   57.14%  |
| 公积金贷款利率               |   3.25%   |
| 贷款期限(年)                 |    30     |
| 契税(万元)                   |   1.50    |
| 中介费(万元)                 |   2.00    |
| 装修费(万元)                 |   10.50   |
| 总支付金额(万元)             |   100.00  |
| 总预算不带装修(万元)         |   103.50  |
| 总预算带装修(万元)           |   114.00  |
| 总花费带利息不带装修（万元） |   203.50  |
| 总花费带利息带装修（万元）   |   214.00  |
| 月供(元)                     | 2930.25   |
| 总支付利息(万元)             |  89.45    |

## 组合贷款方案-等额本金
| 项目                         |    数值   |
|:----------------------------:|:---------:|
| 房屋总价(万元)               |   100.00  |
| 首付比例                     |   30.00%  |
| 首付款(万元)                 |   30.00   |
| 贷款金额(万元)               |   70.00   |
| 公积金贷款金额(万元)         |   30.00   |
| 商业贷款金额(万元)           |   40.00   |
| 公积金贷款比例               |   42.86%  |
| 商业贷款比例                 |   57.14%  |
| 公积金贷款利率               |   3.25%   |
| 贷款期限(年)                 |    30     |
| 契税(万元)                   |   1.50    |
| 中介费(万元)                 |   2.00    |
| 装修费(万元)                 |   10.50   |
| 总支付金额(万元)             |   100.00  |
| 总预算不带装修(万元)         |   103.50  |
| 总预算带装修(万元)           |   114.00  |
| 总花费带利息不带装修（万元） |   203.50  |
| 总花费带利息带装修（万元）   |   214.00  |
| 首月还款额(元)               |  3421.34  |
| 末月还款额(元)               |  1821.34  |
| 每月递减金额(元)             |    6.67   |
| 总支付利息(万元)             |  89.45    |

...
```

## 贡献

欢迎提出建议和发现问题。如果有改进意见或发现BUG，请通过提交Issue或Pull Request的方式进行反馈。

## 许可证

该项目采用MIT许可证进行授权，详情请参见项目根目录下的`LICENSE`文件。
